{"version":3,"file":"api-count.umd.js","sources":["ng://api-count/lib/loader.service.ts","ng://api-count/lib/api-count.interceptor.ts","ng://api-count/lib/api-count.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class LoaderService {\n\n    apiCount: number = 0;\n\n    private api: BehaviorSubject<number> = new BehaviorSubject(this.apiCount);\n    apiCountObservable = this.api.asObservable();\n\n    constructor() { }\n\n    addAPI() {\n        this.apiCount += 1;\n        this.api.next(this.apiCount);\n        console.log(`Ongoing API count ${this.apiCount}`)\n    }\n    removeAPI() {\n        this.apiCount -= 1;\n        this.api.next(this.apiCount);\n        console.log(`Ongoing API count ${this.apiCount}`)\n    }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { HttpRequest, HttpHandler, HttpEvent, HttpResponse, HttpErrorResponse, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Observable, throwError } from 'rxjs';\nimport { map, catchError, timeout } from 'rxjs/operators';\nimport { LoaderService } from './loader.service';\n\n@Injectable({\n    providedIn: 'root'\n})\n\nexport class ApiCountInterceptor {\n    constructor(private injector: Injector) {\n\n    }\n\n    intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n        const loaderService = this.injector.get(LoaderService);\n\n        let cloneChanges: any = {};\n\n        //Modify Request\n        const authReq = req.clone(cloneChanges)\n\n        loaderService.addAPI();\n\n        return next.handle(authReq).pipe(\n            map((event: HttpEvent<any>) => {\n                if (event instanceof HttpResponse) {\n                    loaderService.removeAPI();\n                }\n                return event;\n            }),\n            catchError((error: HttpErrorResponse) => {\n                let data = {};\n                data = {\n                    reason: error && error.error && error.error.reason ? error.error.reason : '',\n                    status: error.status\n                };\n                loaderService.removeAPI();\n                return throwError(error);\n            }));\n    }\n}\n\nexport const httpInterceptorProviders = [\n    { provide: HTTP_INTERCEPTORS, useClass: ApiCountInterceptor, multi: true },\n];\n","import { NgModule } from '@angular/core';\nimport { httpInterceptorProviders } from './api-count.interceptor';\n\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n  ],\n  providers: [httpInterceptorProviders],\n  exports: []\n})\nexport class ApiCountModule { }\n\n\n"],"names":["BehaviorSubject","Injectable","map","HttpResponse","catchError","throwError","Injector","HTTP_INTERCEPTORS","NgModule"],"mappings":";;;;;;;;;;;AAAA;QAaI;YALA,aAAQ,GAAW,CAAC,CAAC;YAEb,QAAG,GAA4B,IAAIA,oBAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC1E,uBAAkB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;SAE5B;;;;QAEjB,8BAAM;;;QAAN;YACI,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC;YACnB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC7B,OAAO,CAAC,GAAG,CAAC,uBAAqB,IAAI,CAAC,QAAU,CAAC,CAAA;SACpD;;;;QACD,iCAAS;;;QAAT;YACI,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC;YACnB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC7B,OAAO,CAAC,GAAG,CAAC,uBAAqB,IAAI,CAAC,QAAU,CAAC,CAAA;SACpD;;oBArBJC,eAAU,SAAC;wBACR,UAAU,EAAE,MAAM;qBACrB;;;;;4BALD;KAGA,IAsBC;;;QAjBG,iCAAqB;;;;;QAErB,4BAA0E;;QAC1E,2CAA6C;;;;;;;;ACXjD;QAWI,6BAAoB,QAAkB;YAAlB,aAAQ,GAAR,QAAQ,CAAU;SAErC;;;;;;QAED,uCAAS;;;;;QAAT,UAAU,GAAqB,EAAE,IAAiB;;gBACxC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC;;gBAElD,YAAY,GAAQ,EAAE;;;gBAGpB,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC;YAEvC,aAAa,CAAC,MAAM,EAAE,CAAC;YAEvB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAC5BC,aAAG;;;;YAAC,UAAC,KAAqB;gBACtB,IAAI,KAAK,YAAYC,iBAAY,EAAE;oBAC/B,aAAa,CAAC,SAAS,EAAE,CAAC;iBAC7B;gBACD,OAAO,KAAK,CAAC;aAChB,EAAC,EACFC,oBAAU;;;;YAAC,UAAC,KAAwB;;oBAC5B,IAAI,GAAG,EAAE;gBACb,IAAI,GAAG;oBACH,MAAM,EAAE,KAAK,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE;oBAC5E,MAAM,EAAE,KAAK,CAAC,MAAM;iBACvB,CAAC;gBACF,aAAa,CAAC,SAAS,EAAE,CAAC;gBAC1B,OAAOC,eAAU,CAAC,KAAK,CAAC,CAAC;aAC5B,EAAC,CAAC,CAAC;SACX;;oBAnCJJ,eAAU,SAAC;wBACR,UAAU,EAAE,MAAM;qBACrB;;;;oBARoBK,aAAQ;;;kCAA7B;KAMA,IAoCC;;;;;;QA/Be,uCAA0B;;;AAiC1C,QAAa,wBAAwB,GAAG;QACpC,EAAE,OAAO,EAAEC,sBAAiB,EAAE,QAAQ,EAAE,mBAAmB,EAAE,KAAK,EAAE,IAAI,EAAE;KAC7E;;;;;;;AC9CD;QAKA;SAO+B;;oBAP9BC,aAAQ,SAAC;wBACR,YAAY,EAAE,EAAE;wBAChB,OAAO,EAAE,EACR;wBACD,SAAS,EAAE,CAAC,wBAAwB,CAAC;wBACrC,OAAO,EAAE,EAAE;qBACZ;;QAC6B,qBAAC;KAP/B;;;;;;;;;;;;;;;"}