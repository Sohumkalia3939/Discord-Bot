{"version":3,"file":"api-count.js","sources":["ng://api-count/lib/loader.service.ts","ng://api-count/lib/api-count.interceptor.ts","ng://api-count/lib/api-count.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class LoaderService {\n\n    apiCount: number = 0;\n\n    private api: BehaviorSubject<number> = new BehaviorSubject(this.apiCount);\n    apiCountObservable = this.api.asObservable();\n\n    constructor() { }\n\n    addAPI() {\n        this.apiCount += 1;\n        this.api.next(this.apiCount);\n        console.log(`Ongoing API count ${this.apiCount}`)\n    }\n    removeAPI() {\n        this.apiCount -= 1;\n        this.api.next(this.apiCount);\n        console.log(`Ongoing API count ${this.apiCount}`)\n    }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { HttpRequest, HttpHandler, HttpEvent, HttpResponse, HttpErrorResponse, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Observable, throwError } from 'rxjs';\nimport { map, catchError, timeout } from 'rxjs/operators';\nimport { LoaderService } from './loader.service';\n\n@Injectable({\n    providedIn: 'root'\n})\n\nexport class ApiCountInterceptor {\n    constructor(private injector: Injector) {\n\n    }\n\n    intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n        const loaderService = this.injector.get(LoaderService);\n\n        let cloneChanges: any = {};\n\n        //Modify Request\n        const authReq = req.clone(cloneChanges)\n\n        loaderService.addAPI();\n\n        return next.handle(authReq).pipe(\n            map((event: HttpEvent<any>) => {\n                if (event instanceof HttpResponse) {\n                    loaderService.removeAPI();\n                }\n                return event;\n            }),\n            catchError((error: HttpErrorResponse) => {\n                let data = {};\n                data = {\n                    reason: error && error.error && error.error.reason ? error.error.reason : '',\n                    status: error.status\n                };\n                loaderService.removeAPI();\n                return throwError(error);\n            }));\n    }\n}\n\nexport const httpInterceptorProviders = [\n    { provide: HTTP_INTERCEPTORS, useClass: ApiCountInterceptor, multi: true },\n];\n","import { NgModule } from '@angular/core';\nimport { httpInterceptorProviders } from './api-count.interceptor';\n\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n  ],\n  providers: [httpInterceptorProviders],\n  exports: []\n})\nexport class ApiCountModule { }\n\n\n"],"names":[],"mappings":";;;;;;;;;;AAAA;IAaI;QALA,aAAQ,GAAW,CAAC,CAAC;QAEb,QAAG,GAA4B,IAAI,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1E,uBAAkB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;KAE5B;;;;IAEjB,8BAAM;;;IAAN;QACI,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC;QACnB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC7B,OAAO,CAAC,GAAG,CAAC,uBAAqB,IAAI,CAAC,QAAU,CAAC,CAAA;KACpD;;;;IACD,iCAAS;;;IAAT;QACI,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC;QACnB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC7B,OAAO,CAAC,GAAG,CAAC,uBAAqB,IAAI,CAAC,QAAU,CAAC,CAAA;KACpD;;gBArBJ,UAAU,SAAC;oBACR,UAAU,EAAE,MAAM;iBACrB;;;;;wBALD;CAGA,IAsBC;;;IAjBG,iCAAqB;;;;;IAErB,4BAA0E;;IAC1E,2CAA6C;;;;;;;;ACXjD;IAWI,6BAAoB,QAAkB;QAAlB,aAAQ,GAAR,QAAQ,CAAU;KAErC;;;;;;IAED,uCAAS;;;;;IAAT,UAAU,GAAqB,EAAE,IAAiB;;YACxC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC;;YAElD,YAAY,GAAQ,EAAE;;;YAGpB,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC;QAEvC,aAAa,CAAC,MAAM,EAAE,CAAC;QAEvB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAC5B,GAAG;;;;QAAC,UAAC,KAAqB;YACtB,IAAI,KAAK,YAAY,YAAY,EAAE;gBAC/B,aAAa,CAAC,SAAS,EAAE,CAAC;aAC7B;YACD,OAAO,KAAK,CAAC;SAChB,EAAC,EACF,UAAU;;;;QAAC,UAAC,KAAwB;;gBAC5B,IAAI,GAAG,EAAE;YACb,IAAI,GAAG;gBACH,MAAM,EAAE,KAAK,IAAI,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE;gBAC5E,MAAM,EAAE,KAAK,CAAC,MAAM;aACvB,CAAC;YACF,aAAa,CAAC,SAAS,EAAE,CAAC;YAC1B,OAAO,UAAU,CAAC,KAAK,CAAC,CAAC;SAC5B,EAAC,CAAC,CAAC;KACX;;gBAnCJ,UAAU,SAAC;oBACR,UAAU,EAAE,MAAM;iBACrB;;;;gBARoB,QAAQ;;;8BAA7B;CAMA,IAoCC;;;;;;IA/Be,uCAA0B;;;AAiC1C,IAAa,wBAAwB,GAAG;IACpC,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,mBAAmB,EAAE,KAAK,EAAE,IAAI,EAAE;CAC7E;;;;;;;AC9CD;IAKA;KAO+B;;gBAP9B,QAAQ,SAAC;oBACR,YAAY,EAAE,EAAE;oBAChB,OAAO,EAAE,EACR;oBACD,SAAS,EAAE,CAAC,wBAAwB,CAAC;oBACrC,OAAO,EAAE,EAAE;iBACZ;;IAC6B,qBAAC;CAP/B;;;;;;;;;;;;;;;;"}